module.exports = {

"[externals]/ [external] (next/dist/compiled/next-server/app-route.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require } = __turbopack_context__;
{
const mod = __turbopack_external_require__("next/dist/compiled/next-server/app-route.runtime.dev.js");

module.exports = mod;
}}),
"[externals]/ [external] (@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require } = __turbopack_context__;
{
const mod = __turbopack_external_require__("@opentelemetry/api");

module.exports = mod;
}}),
"[externals]/ [external] (next/dist/compiled/next-server/app-page.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require } = __turbopack_context__;
{
const mod = __turbopack_external_require__("next/dist/compiled/next-server/app-page.runtime.dev.js");

module.exports = mod;
}}),
"[externals]/ [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require } = __turbopack_context__;
{
const mod = __turbopack_external_require__("next/dist/server/app-render/work-unit-async-storage.external.js");

module.exports = mod;
}}),
"[externals]/ [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, m: module, e: exports, t: require } = __turbopack_context__;
{
const mod = __turbopack_external_require__("next/dist/server/app-render/work-async-storage.external.js");

module.exports = mod;
}}),
"[project]/app/api/campaign/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, x: __turbopack_external_require__, y: __turbopack_external_import__, z: require } = __turbopack_context__;
{
__turbopack_esm__({
    "DELETE": (()=>DELETE),
    "GET": (()=>GET),
    "POST": (()=>POST),
    "PUT": (()=>PUT)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jsonwebtoken$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/jsonwebtoken/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$dbConfig$2f$dbConfig$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/dbConfig/dbConfig.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/models/campaignModel.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_import__("[project]/node_modules/next/server.js [app-route] (ecmascript)");
;
;
;
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$dbConfig$2f$dbConfig$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"])();
// Helper function to verify token and extract user data
const verifyToken = (request)=>{
    const token = request.cookies.get('token');
    if (!token) {
        throw new Error('Authentication token missing');
    }
    try {
        const user = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jsonwebtoken$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].verify(token, process.env.JWT_SECRET_KEY);
        return user;
    } catch (error) {
        throw new Error('Invalid or expired token');
    }
};
// Success response helper
const successResponse = (message, data = null)=>{
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
        success: true,
        message,
        data,
        status: 200
    });
};
// Error response helper
const errorResponse = (message, status = 400)=>{
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
        success: false,
        error: message,
        status
    });
};
async function POST(request) {
    try {
        const reqBody = await request.json();
        const { title, description, image, category, targetAmount, requestedBy, createdBy } = reqBody;
        // Validation
        if (!title || !description || !targetAmount || !category || !requestedBy) {
            return errorResponse("Title, description, targetAmount, category, and requestedBy are required", 400);
        }
        // Ensure targetAmount is a number
        const targetAmountNum = Number(targetAmount);
        if (isNaN(targetAmountNum)) {
            return errorResponse("Target Amount must be a valid number", 400);
        }
        // Create Campaign
        const campaign = new __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"]({
            title,
            description,
            image,
            category,
            targetAmount: targetAmountNum,
            requestedBy,
            createdBy
        });
        await campaign.save();
        return successResponse("Campaign created successfully", campaign);
    } catch (error) {
        console.error('Error creating campaign:', error);
        return errorResponse(error.message || 'Server error while creating campaign', 500);
    }
}
async function GET(request) {
    try {
        const { searchParams } = new URL(request.url);
        const category = searchParams.get('category'); // Get category from query params
        const filter = {};
        if (category) filter.category = category; // Apply filter for category
        const campaigns = await __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].find(filter).populate('requestedBy createdBy', 'username email');
        return successResponse("Campaigns fetched successfully", campaigns);
    } catch (error) {
        console.error('Error fetching campaigns:', error);
        return errorResponse(error.message || 'Server error while fetching campaigns', 500);
    }
}
async function PUT(request) {
    try {
        const user = verifyToken(request); // Verify and extract user data
        const reqBody = await request.json();
        const { id, title, description, image, category, targetAmount } = reqBody;
        // Validation
        if (!id || !title && !description && !image && !category && !targetAmount) {
            return errorResponse("ID and at least one field to update are required", 400);
        }
        // Find the campaign
        const campaign = await __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].findById(id);
        if (!campaign) {
            return errorResponse("Campaign not found", 404);
        }
        // Security check: Ensure only admin or creator can update
        if (user.role !== 'admin' && user.id !== String(campaign.createdBy)) {
            return errorResponse("You are not authorized to update this campaign", 403);
        }
        // Update fields
        if (title) campaign.title = title;
        if (description) campaign.description = description;
        if (image) campaign.image = image; // You might need extra logic to handle file uploads here
        if (category) campaign.category = category;
        if (targetAmount) campaign.targetAmount = Number(targetAmount); // Ensure targetAmount is a number
        await campaign.save();
        return successResponse("Campaign updated successfully", campaign);
    } catch (error) {
        console.error('Error updating campaign:', error);
        return errorResponse(error.message || 'Server error while updating campaign', 500);
    }
}
async function DELETE(request) {
    try {
        const user = verifyToken(request); // Verify and extract user data
        const { searchParams } = new URL(request.url);
        const id = searchParams.get('id');
        // Validation
        if (!id) {
            return errorResponse("Campaign ID is required", 400);
        }
        // Find the campaign
        const campaign = await __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].findById(id);
        if (!campaign) {
            return errorResponse("Campaign not found", 404);
        }
        // Security check: Ensure only admin or creator can delete
        if (user.role !== 'admin' && user.id !== String(campaign.createdBy)) {
            return errorResponse("You are not authorized to delete this campaign", 403);
        }
        await __TURBOPACK__imported__module__$5b$project$5d2f$models$2f$campaignModel$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].findByIdAndDelete(id);
        return successResponse("Campaign deleted successfully");
    } catch (error) {
        console.error('Error deleting campaign:', error);
        return errorResponse(error.message || 'Server error while deleting campaign', 500);
    }
}
}}),
"[project]/ (server-utils)": ((__turbopack_context__) => {

var { r: __turbopack_require__, f: __turbopack_module_context__, i: __turbopack_import__, s: __turbopack_esm__, v: __turbopack_export_value__, n: __turbopack_export_namespace__, c: __turbopack_cache__, M: __turbopack_modules__, l: __turbopack_load__, j: __turbopack_dynamic__, P: __turbopack_resolve_absolute_path__, U: __turbopack_relative_url__, R: __turbopack_resolve_module_id_path__, b: __turbopack_worker_blob_url__, g: global, __dirname, t: require } = __turbopack_context__;
{
}}),

};

//# sourceMappingURL=%5Broot%20of%20the%20server%5D__ae6566._.js.map