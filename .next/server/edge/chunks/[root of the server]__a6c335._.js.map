{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/helpers/getDataFromToken.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\nimport jwt from \"jsonwebtoken\";\nexport const getDataFromToken = (request: NextRequest) => {\n    try {\n      const token = request.cookies.get(\"token\")?.value || '';\n      const decodedToken: any = jwt.verify(token, process.env.TOKEN_SECRET!);\n  \n      // Assuming the token contains both `id` and `role`\n      return { id: decodedToken.id, role: decodedToken.role };\n    } catch (error: any) {\n      throw new Error(error.message);\n    }\n  };"],"names":[],"mappings":";;;AACA;;AACO,MAAM,mBAAmB,CAAC;IAC7B,IAAI;QACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU,SAAS;QACrD,MAAM,eAAoB,qIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,YAAY;QAEpE,mDAAmD;QACnD,OAAO;YAAE,IAAI,aAAa,EAAE;YAAE,MAAM,aAAa,IAAI;QAAC;IACxD,EAAE,OAAO,OAAY;QACnB,MAAM,IAAI,MAAM,MAAM,OAAO;IAC/B;AACF"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/middleware.ts"],"sourcesContent":["// src/middleware.ts\n\nimport { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\nimport { getDataFromToken } from \"@/helpers/getDataFromToken\";\n\nexport async function middleware(request: NextRequest) {\n  const path = request.nextUrl.pathname;\n  const isPublicPath = ['/login', '/signup', '/verifyemail'].includes(path);\n  const token = request.cookies.get('token')?.value || '';\n\n  let userRole = '';\n\n  // Check if token exists and extract user role\n  if (token) {\n    try {\n      const { role } = await getDataFromToken(request);\n      userRole = role;\n    } catch (error) {\n      return NextResponse.redirect(new URL('/login', request.nextUrl));\n    }\n  }\n\n  // Define role-based access\n  const rolePaths = {\n    admin: ['/admin', '/profile', '/dashboard'],\n    user: ['/profile', '/dashboard', '/user'],\n    organizer: ['/organizer', '/profile', '/events'],\n  };\n\n  const isAuthorized = (role: string, path: string) => {\n    return rolePaths[role]?.includes(path) || isPublicPath;\n  };\n\n  // Redirect based on user authentication and authorization\n  if (isPublicPath && token) {\n    return NextResponse.redirect(new URL('/', request.nextUrl));\n  }\n\n  if (!isPublicPath && !token) {\n    return NextResponse.redirect(new URL('/login', request.nextUrl));\n  }\n\n  if (!isAuthorized(userRole, path)) {\n    return NextResponse.redirect(new URL('/', request.nextUrl));\n  }\n}\n\n// Configuration to match paths\nexport const config = {\n  matcher: ['/', '/profile', '/login', '/signup', '/verifyemail', '/admin', '/user', '/organizer']\n};\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AAEpB;AAEA;AAFA;;;AAIO,eAAe,WAAW,OAAoB;IACnD,MAAM,OAAO,QAAQ,OAAO,CAAC,QAAQ;IACrC,MAAM,eAAe;QAAC;QAAU;QAAW;KAAe,CAAC,QAAQ,CAAC;IACpE,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,UAAU,SAAS;IAErD,IAAI,WAAW;IAEf,8CAA8C;IAC9C,IAAI,OAAO;QACT,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,CAAA,GAAA,2HAAA,CAAA,mBAAgB,AAAD,EAAE;YACxC,WAAW;QACb,EAAE,OAAO,OAAO;YACd,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,OAAO;QAChE;IACF;IAEA,2BAA2B;IAC3B,MAAM,YAAY;QAChB,OAAO;YAAC;YAAU;YAAY;SAAa;QAC3C,MAAM;YAAC;YAAY;YAAc;SAAQ;QACzC,WAAW;YAAC;YAAc;YAAY;SAAU;IAClD;IAEA,MAAM,eAAe,CAAC,MAAc;QAClC,OAAO,SAAS,CAAC,KAAK,EAAE,SAAS,SAAS;IAC5C;IAEA,0DAA0D;IAC1D,IAAI,gBAAgB,OAAO;QACzB,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,OAAO;IAC3D;IAEA,IAAI,CAAC,gBAAgB,CAAC,OAAO;QAC3B,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,OAAO;IAChE;IAEA,IAAI,CAAC,aAAa,UAAU,OAAO;QACjC,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,OAAO;IAC3D;AACF;AAGO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAK;QAAY;QAAU;QAAW;QAAgB;QAAU;QAAS;KAAa;AAClG"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}